#summary UEFI: Preparation

= Introduction =

= Preparation =

  * Download the [http://dev.pentoo.ch/~zero/isos/ Pentoo 2012.0 Beta3 Release]
  * Use unetbootin to burn the iso to an USB stick.
  * It should have a msdos partition layout and a fat32 partition with the boot flag enabled.

= Writable Partition =

Boot to that stick and run:
{{{
chmod a+rx /etc/local.d/99-remount-cd-rw.start
/etc/local.d/99-remount-cd-rw.start
flushchanges    # this should work now
}}}
Remember to run flushchanges to save changes before any reboot!

= Optional =

== EFI-based Framebuffer Support (CONFIG_FB_EFI) ==
*Optional, but recommended*<br/>
Boot failures are difficult to see too without *EFI-based Framebuffer Support*, so it helps to have it enabled.

=== Download patched kernel ===
For quick tests a kernel is available for download at:<br/>
[http://pentoo-uefi.googlecode.com/files/kernel-genkernel-x86_64-3.5.4-pentoo kernel-genkernel-x86_64-3.5.4-pentoo]<br/>
This example assumes an installation of Pentoo to an USB stick with unetbootin.
{{{
cd
wget http://pentoo-uefi.googlecode.com/files/kernel-genkernel-x86_64-3.5.4-pentoo
mv /mnt/cdrom/boot/pentoo /mnt/cdrom/boot/pentoo.orig
cp kernel-genkernel-x86_64-3.5.4-pentoo /mnt/cdrom/boot/pentoo
}}}
_This installs only the kernel and does not touch its config, CONFIG_FB_EFI has to be re-enabled if the kernel is rebuilt!_

=== Build new kernel ===
These instructions build the same kernel as in the download.
{{{
cd /usr/src/linux
genkernel --splash --no-install --no-clean --menuconfig bzImage
}}}
and enable "EFI-based Framebuffer Support" (CONFIG_FB_EFI) at location:<br/>
-> Device Drivers
  -> Graphics support
    -> Support for frame buffer devices (FB [=y])

This example assumes an installation of Pentoo to an USB stick with unetbootin.<br/>
Copy the new kernel:
{{{
mv /mnt/cdrom/boot/pentoo /mnt/cdrom/boot/pentoo.orig
mv /boot/kernel-genkernel-x86_64-3.5.4-pentoo /boot/kernel-genkernel-x86_64-3.5.4-pentoo.orig
cp arch/x86_64/boot/bzImage /mnt/cdrom/boot/pentoo
cp arch/x86_64/boot/bzImage /boot/kernel-genkernel-x86_64-3.5.4-pentoo
}}}